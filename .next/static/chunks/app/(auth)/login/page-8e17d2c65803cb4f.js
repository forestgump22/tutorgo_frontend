(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{5582:function(e,r,t){Promise.resolve().then(t.bind(t,2743))},9376:function(e,r,t){"use strict";var s=t(5475);t.o(s,"useParams")&&t.d(r,{useParams:function(){return s.useParams}}),t.o(s,"usePathname")&&t.d(r,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(r,{useSearchParams:function(){return s.useSearchParams}})},2743:function(e,r,t){"use strict";t.d(r,{default:function(){return c}});var s=t(7437),a=t(2265),n=t(9376),o=t(1614),l=t(2223),i=t(5447),u=t(8229);function c(){let[e,r]=(0,a.useState)(""),[t,c]=(0,a.useState)(""),[d,m]=(0,a.useState)(null),[h,g]=(0,a.useState)(!1),f=(0,n.useRouter)(),x=(0,n.useSearchParams)(),[p,b]=(0,a.useState)(null),v=(0,l.t)(e=>e.setAuth);(0,a.useEffect)(()=>{let e=x.get("message");e&&b(e)},[x]);let y=(0,a.useCallback)(e=>{(0,o.setCookie)("token",e.accessToken,{path:"/",maxAge:86400}),v(e.accessToken,e.user),f.push("/dashboard"),f.refresh()},[v,f]),w=async r=>{r.preventDefault(),g(!0),m(null);try{let r=await (0,i.pH)({email:e,password:t});y(r)}catch(e){m(e.message)}finally{g(!1)}},j=async e=>{g(!0),m(null);try{if(e.credential){let r=await (0,i.Cb)(e.credential);y(r)}else throw Error("No se recibi\xf3 la credencial de Google.")}catch(e){m(e.message)}finally{g(!1)}};return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 px-4",children:(0,s.jsxs)("div",{className:"w-full max-w-md p-8 space-y-6 bg-white rounded-xl shadow-lg",children:[(0,s.jsx)("h2",{className:"text-3xl font-extrabold text-center text-gray-900",children:"Iniciar Sesi\xf3n en TutorGo"}),(0,s.jsxs)("div",{className:"min-h-[3rem]",children:[p&&(0,s.jsx)("div",{className:"p-3 text-sm text-green-700 bg-green-100 rounded-lg",children:p}),d&&(0,s.jsx)("div",{className:"p-3 text-sm text-red-700 bg-red-100 rounded-lg",children:d})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(u.kZ,{onSuccess:j,onError:()=>{m("El inicio de sesi\xf3n con Google fall\xf3. Por favor, int\xe9ntelo de nuevo.")},useOneTap:!0})}),(0,s.jsxs)("div",{className:"relative flex py-2 items-center",children:[(0,s.jsx)("div",{className:"flex-grow border-t border-gray-300"}),(0,s.jsx)("span",{className:"flex-shrink mx-4 text-gray-400 text-sm",children:"O contin\xfaa con"}),(0,s.jsx)("div",{className:"flex-grow border-t border-gray-300"})]}),(0,s.jsxs)("form",{className:"space-y-6",onSubmit:w,children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correo Electr\xf3nico"}),(0,s.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>r(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrase\xf1a"}),(0,s.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:t,onChange:e=>c(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),d&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:d}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",disabled:h,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-400",children:h?"Ingresando...":"Iniciar Sesi\xf3n"})})]}),(0,s.jsxs)("p",{className:"text-sm text-center text-gray-600",children:["\xbfNo tienes una cuenta?"," ",(0,s.jsx)("a",{href:"/register",className:"font-medium text-blue-600 hover:text-blue-500",children:"Reg\xedstrate"})]})]})})}},1837:function(e,r,t){"use strict";var s=t(3464),a=t(1614);let n=s.Z.create({baseURL:"https://tutorgo-api.onrender.com/api/v1",headers:{"Content-Type":"application/json"}});console.log(n.defaults.baseURL),n.interceptors.request.use(e=>{let r=(0,a.getCookie)("token");return r&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),r.Z=n},5447:function(e,r,t){"use strict";t.d(r,{Cb:function(){return o},a$:function(){return n},pH:function(){return a}});var s=t(1837);let a=async e=>{try{return(await s.Z.post("/auth/login",e)).data}catch(e){var r,t;throw Error((null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Error al iniciar sesi\xf3n")}},n=async e=>{try{let r=await s.Z.post("/auth/register",e);if(r.data.success)return{message:r.data.message,data:r.data.data};throw Error(r.data.message||"Error en el registro.")}catch(e){var r,t;throw Error((null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||e.message||"Error desconocido en el registro.")}},o=async e=>{try{return(await s.Z.post("/auth/google",{googleToken:e})).data}catch(e){var r,t;throw Error((null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Error en el inicio de sesi\xf3n con Google")}}},2223:function(e,r,t){"use strict";t.d(r,{t:function(){return o}});var s=t(9625),a=t(1614),n=t(4474);let o=(0,s.Ue)((e,r)=>({token:null,user:null,isLoading:!0,setAuth:(r,t)=>{e({token:r,user:t,isLoading:!1})},logout:()=>{e({token:null,user:null,isLoading:!1})},hydrateAuth:()=>{{let r=(0,a.getCookie)("token");if(r)try{let t=(0,n.o)(r),s="ESTUDIANTE";t.roles&&t.roles.toUpperCase().includes("TUTOR")&&(s="TUTOR");let a={id:t.userId,email:t.sub,nombre:t.nombre,rol:s};e({token:r,user:a,isLoading:!1})}catch(r){console.error("Error decodificando token al hidratar o token inv\xe1lido:",r),(0,a.deleteCookie)("token",{path:"/"}),e({token:null,user:null,isLoading:!1})}else e({isLoading:!1})}},isAuthenticated:()=>!!r().token,updateUser:r=>{e(e=>({...e,user:r}))}}))}},function(e){e.O(0,[144,735,971,117,744],function(){return e(e.s=5582)}),_N_E=e.O()}]);